<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Easy AI Learn</title>
    <style type="text/css">
        body {
     font-family: Times New Roman, sans-serif;
    }
    #message {
     display: none; /* –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞ */
    }
    #message_one {
     display: none; /* –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞ */
    }
    .answer {
     font-weight: 700;
    }
    .popup {
     position: relative;
     display: inline-block;
     cursor: pointer;
    }
    .popup .b-popup {
     visibility: hidden;
    }
    .popup .show {
     visibility: visible;
     -webkit-animation: fadeIn 1s;
     animation: fadeIn 1s;
    }
    .popuptext{
     height:65%;
     background-color: rgba(0,0,0,0.5);
     overflow:auto;
     position:fixed;
     top:10%;
     width: auto;
     background-color: #6A5ACD;
     color: #fff;
     text-align: justify;
     border-radius: 10px;
     padding: 20px;
     position: fixed;
     z-index: 1;
     bottom: 125%;
     margin-left: 10%;
     margin-right: 10%;
    }
    .b-popup{
     width:100%;
     height: 100%;
     background-color: rgba(0,0,0,0.5);
     overflow:hidden;
     position:fixed;
     top:0px;
     left:0%;
     right:0%;
    }
    .head {
     font-size: 125%;
     font-family: Times New Roman;
     top: 5px;
    }
    .rightimg  {
     float: right;
     margin: 7px 0 7px 7px;
    }
    #question:hover {
     cursor: pointer;
     text-decoration: underline;
     color: #4B0082;
    }
    #question {
     color: #0000FF;
    }
    header {
     background: #0247d1;
    }
    h1{
     color: #d9fffb;
    }
    .abc {
     underline: false;
     color: #000000
    }
    .head {
     color: #d9fffb;
    }
    .text_head{
     font-size: 150%; /* –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö */
     font-family: serif; /* –®—Ä–∏—Ñ—Ç —Å –∑–∞—Å–µ—á–∫–∞–º–∏ */
    }
    .file {
     background: #6495ED;
    }
    .file-drop {
    background:#fff;
    margin:auto;
    padding:50px 50px;
    border:2px solid #333;
    border-radius: 20px;
    }
    .file-drop_dragover {
    border:2px dashed #333;
    }
    .file-drop__input {
    border:0;
    }
    .message-div {
    background:#fefefe;
    border:2px solid #333;
    color:#333;
    width:350px;
    height:150px;
    position:fixed;
    bottom:25px;
    right:25px;
    font-size:15px;
    padding:5px;
    z-index:99999;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    .message-div_hidden {
    right:-9999999999999999999px;
    }
    .name-project {
    padding: 5px;
    display: flex;
    justify-content: center;
    font-size: xx-large;
    cursor: pointer;
    }
    .change-name-project {
    padding: 5px;
    }
    .name-classes {
    padding: 5px;
    font-size: x-large;
    cursor: pointer;
    }
    .change-name-classes {
    padding: 5px;
    }
    .non-decoration {
     text-decoration: none;
    }
    </style>
<!--        border: 1px solid #ccc;-->
        <!-- CSS only -->
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
    <!-- development version, includes helpful console warnings -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <!-- production version, optimized for size and speed -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/vue@2"></script> -->
</head>
<body>
    <header>
        <div class="container">
            <div class="popup">
                <span class="b-popup" id="myPopup" align="center" onclick="popup(event)">
                    <div class="popuptext" align="center">
                        <p>‚ú® –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å‚Äì –æ–±—É—á–µ–Ω–∏–µ –ò–ò —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∞—É–¥–∏–æ, —Ç–µ–∫—Å—Ç) –≤—Å–µ–≥–æ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª–∏–∫–æ–≤.<br>
                            üöÄ –ì–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è ‚Äì –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤, –∑–≤—É–∫–æ–≤, –∂–µ—Å—Ç–æ–≤ –∏ —Ç–µ–∫—Å—Ç–∞.<br>
                            ‚òÅÔ∏è –û–±–ª–∞—á–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è ‚Äì –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ –º–æ—â–Ω–æ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏.<br>
                        </p>
                    </div>
                </span>
            </div>
            <div class="container">
            <div class="row">
                <div class="col col-lg-8">
                    <h1><a href="/" class="head non-decoration">Easy AI Learn</a></h1>
                </div>
                <div class="col col-lg-4" align="right">
                    <button onclick="popup(event)" class="btn btn-outline-light text_head">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
                </div>
            </div>
            </div>
        </div>
    </header>
    <div id="app">
    <div id="fileZone" class="container file">
        <div class="row">
            <div @click="editName = true" v-if="!editName" class="name-project">
              [[ nameProject ]]
            </div>
            <input v-model="nameProject" v-if="editName" @blur="saveName" @keyup.enter="saveName" style="padding: 5px;">
        </div>
        <div class="row">
            <div class="col col-lg-6">
            <form id="uploadForm" enctype="multipart/form-data">
                <h4><b>–ó–∞–≥—Ä—É–∑–∏—Ç–µ dataset:</b></h4>
                  <div v-for="(item, index) in items" :key="index" style="margin-bottom: 20px;">
                    <div @click="item.editMode = true" v-if="!item.editMode" class="name-classes">
                      [[ item.text ]]
                    </div>
                    <input v-model="item.text" v-if="item.editMode" @blur="() => save(item)" @keyup.enter="() => save(item)" class="change-name-classes">

                    <input :data-group-name="item.text" :data-project-name="nameProject" type="file" class='file-drop files-dataset' :ref="'fileInput' + index" multiple required><br>
                  </div>
                  <button @click="addItem" class="btn btn-light">–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∞—Å—Å</button><br><br>
                <a href="/audio_all_dataset" class="abc">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ä–∞–∑—É –≤–µ—Å—å dataset</a><br><br>

                <div class="row"><div class="col col-lg-4">
                <p><b>–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö:</b><br>
                    <input type="text" name="epochs" :data-project-name="nameProject" class="form-control" id="epochs" size="40">
                </p><br>
                </div></div>
                <button type="submit button" class="btn btn-info">–û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å</button><br>
                <div id="result" class="answer"></div>
            </form>
            </div>
        <div class="col col-lg-6">
            <h2>–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å</h2><br>
            <form id="uploadFormTest" enctype="multipart/form-data">
                <input type="file" id="fileInputTest" class='file-drop' name="files" multiple required><br>
                <button type="submit button" class="btn btn-info">–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å</button><br>
                <div id="result_test" class="answer"></div>
            </form><br>

            <button id="downloadBtn" type="submit button" class="btn btn-light">
                –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å
            </button><br>
        </div>
        </div>
        </div>
    </div>
    <script type="text/javascript">
        var app = new Vue({
          el: '#app',
          delimiters: ['[[', ']]'],
          data() {
            return {
              nameProject: '–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç —Å –∞—É–¥–∏–æ',
              editName: false,
              items: [
                { text: '–ö–ª–∞—Å—Å 1', editMode: false, files: [] }
              ]
            }
          },
          methods: {
            addItem() {
              const newIndex = this.items.length + 1
              this.items.push({ text: '–ö–ª–∞—Å—Å ' + newIndex, editMode: false, files: [] });
            },
            save(item) {
              item.editMode = false;
            },
            saveName() {
              this.editName = false;
            },
          }
        });
    </script>
    <script type="text/javascript">
        function popup(event) {
            var popup = document.getElementById("myPopup");
            popup.classList.toggle("show");
        }

        const button = document.getElementById('showButton');
        const message = document.getElementById('message');

        button.addEventListener('click', () => {
            message.style.display = 'block'; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–¥–ø–∏—Å—å
        });
    </script>
    <script type="text/javascript">
        document.getElementById('uploadForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const fileInputs = document.querySelectorAll('.files-dataset');
            for (fileInput of fileInputs) {
              const formData = new FormData();
              formData.append('DirName', fileInput.getAttribute("data-group-name"));
              formData.append('ProjectName', fileInput.getAttribute("data-project-name"));
              for (const file of fileInput.files) {
                formData.append('files[]', file);
              }
              fetch('/part_dataset_upload', {
                method: 'POST',
                body: formData,
              })
            }

            const formData = new FormData();
            const epochs = document.getElementById('epochs');

            formData.append('epochs', epochs.value);
            formData.append('ProjectName', epochs.getAttribute("data-project-name"));

            fetch('/audio_part_dataset_train', {
                method: 'POST',
                body: formData,
            })
            .then(response => response.text())
            .then(data => {
                document.getElementById('result').innerText = data;
            })
            .catch(error => {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–∞–π–ª–∞: ' + error);
            });
        });

        document.getElementById('uploadFormTest').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData();
            const fileField = document.getElementById('fileInputTest');

            if (fileField.files.length === 0) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª');
                return;
            }

            formData.append('file', fileField.files[0]);

            fetch('/audio_test', {
                method: 'POST',
                body: formData
            })
            .then(response => response.text())
            .then(data => {
                document.getElementById('result_test').innerText = data;
            })
            .catch(error => {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–∞–π–ª–∞: ' + error);
            });
        });


        document.getElementById('downloadBtn').addEventListener('click', () => {
          fetch('upload_neuro')
            .then(response => {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.blob(); // –ü–æ–ª—É—á–∞–µ–º —Ñ–∞–π–ª –∫–∞–∫ Blob
            })
            .then(blob => {
              // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
              const url = window.URL.createObjectURL(blob);
              const a = document.createElement('a');
              a.href = url;

              // –£–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
              a.download = 'neuro.jpg'; // –Ω–∞–ø—Ä–∏–º–µ—Ä, 'report.pdf'

              document.body.appendChild(a);
              a.click();

              // –£–¥–∞–ª—è–µ–º —Å—Å—ã–ª–∫—É –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã
              a.remove();
              window.URL.revokeObjectURL(url);
            })
            .catch(error => {
              console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞:', error);
            });
        });
    </script>
</body>
</html>